fit2$pred
fit2$pred
fitcontrol1 <- trainControl(method = "repeatedcv", number = 5, repeats = 10, savePred=TRUE)
fitcontrol1 <- trainControl(method = "repeatedcv", number = 5, repeats = 10, savePred=TRUE)
set.seed(100)
fit1 <- train(mpg ~ ., data = d, method = "lm", trControl = fitcontrol1)
fit1$pred
fit1$pred
fit1
fit1$coef
summary(fit1)
summary(fit1)
summary(reg)
predict(fit1)
predict(reg)
predict(fit1, d)
predict(reg, d)
reg$coef
fit1$coef
fit1$results
fit1$bestTune
fit1$results
fit1$bestTune
fit1$metric
fit1$bestTune
Imp <- varImpt(fit1, scale = FALSE)
Imp <- varImp(fit1, scale = FALSE)
Imp
Imp <- varImp(fit1)
Imp
Imp <- varImp(fit1, scale = FALSE)
Imp
install.packages("devtools", dependencies = TRUE)
library(devtools)
has_devel()
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("breakdown_2014.Rda")
data2014 <- readRDS("breakdown2014.Rda")
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
# plotting Europe matchups
b <- subset(data, continent == "europe")
ggplot(data = b, aes(x=opposition_continent, y=gf_game)) + geom_bar(stat = "identity")
b <- melt(b)
b <- rbind(subset(b, variable=="gf_game"),subset(b, variable=="ga_game"))
ggplot(b, aes(x = opposition_continent)) +
geom_bar(data = subset(b, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(b, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-2.5,2.5)
ggsave(file="europe.png")
# function to get the data in the correct format for graphing
subsetting <- function(cont,d) {
t1 <- subset(d, continent == cont)
t2 <- subset(d, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
for_comparison <- function(cont) {
}
# do the same for CONCACAF
t <- subsetting("concacaf",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("CONCACAF") + ylim(-3,3)
ggsave(file="concacaf.png")
View(data)
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
for_comparison <- function(cont) {
d1 <- subset(d, continent == cont)
d1_opps <- unique(d1$opposition_continent)
d2 <- subset(d, opposition_continent %in% cont)
m <- rbind(d1, d2)
return(m)
}
# europe
m <- for_comparison("europe")
for_comparison <- function(cont) {
d1 <- subset(data2014, continent == cont)
d1_opps <- unique(d1$opposition_continent)
d2 <- subset(data, opposition_continent %in% cont)
m <- rbind(d1, d2)
return(m)
}
# europe
m <- for_comparison("europe")
View(m)
data2014$continent <- lapply(data2014$continent, function(x) gsub(" ", "", tolower(x)))
View(data2014)
data2014$opposition_continent <- lapply(data2014$opposition_continent, function(x) gsub(" ", "", tolower(x)))
View(data2014)
for_comparison <- function(cont) {
d1 <- subset(data2014, continent == cont)
d1_opps <- unique(d1$opposition_continent)
d2 <- subset(data, opposition_continent %in% cont)
m <- rbind(d1, d2)
return(m)
}
m <- for_comparison("europe")
View(m)
for_comparison <- function(cont) {
d1 <- subset(data2014, continent == cont)
d1_opps <- unique(d1$opposition_continent)
d2 <- subset(data, opposition_continent %in% d1_opps)
m <- rbind(d1, d2)
return(m)
}
m <- for_comparison("europe")
View(m)
m <- merge(d1, d2, by="opposition_continent")
for_comparison <- function(cont) {
d1 <- subset(data2014, continent == cont)
d1_opps <- unique(d1$opposition_continent)
d2 <- subset(data, opposition_continent %in% d1_opps)
m <- merge(d1, d2, by="opposition_continent")
return(m)
}
m <- for_comparison("europe")
str(data)
str(data2014)
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) gsub(" ", "", tolower(x))))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "", tolower(x))))
# europe
m <- for_comparison("europe")
View(m)
for_comparison <- function(cont) {
d1 <- subset(data2014, continent == cont)
d1_opps <- unique(d1$opposition_continent)
d2 <- subset(data, opposition_continent %in% d1_opps)
m <- rbind(d1, d2)
}
# do the same for CONCACAF
m <- for_comparison("europe")
View(m)
t <- subset(data2014, continent == "europe")
View(data2014)
for_comparison <- function(cont) {
d1 <- subsetting(data2014, cont)
d1_opps <- unique(d1$opposition_continent)
d2 <- subset(data, opposition_continent %in% d1_opps)
m <- rbind(d1, d2)
}
t <- subsetting(data2014, "europe")
View(data2014)
t <- subsetting(data2014, "europe")
t <- subsetting("europe", data2014)
View(t)
d2 <- subsetting(data, cont)
s <- subsetting("europe", data)
for_comparison <- function(cont) {
d1 <- subsetting(data2014, cont)
d1_opps <- unique(d1$opposition_continent)
d2 <- subsetting(data, cont)
d2 <- subset(data, opposition_continent %in% d1_opps)
m <- rbind(d1, d2)
}
m <- for_comparison("europe")
for_comparison <- function(cont) {
d1 <- subsetting(dacont, data2014)
d1_opps <- unique(d1$opposition_continent)
d2 <- subsetting(cont, data)
d2 <- subset(data, opposition_continent %in% d1_opps)
m <- rbind(d1, d2)
}
m <- for_comparison("europe")
for_comparison <- function(cont) {
d1 <- subsetting(cont, data2014)
d1_opps <- unique(d1$opposition_continent)
d2 <- subsetting(cont, data)
d2 <- subset(data, opposition_continent %in% d1_opps)
m <- rbind(d1, d2)
}
m <- for_comparison("europe")
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) gsub(" ", "", tolower(x))))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "", tolower(x))))
# function to get the data in the correct format for graphing
subsetting <- function(cont,d) {
t1 <- subset(d, continent == cont)
t2 <- subset(d, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
t <- subsetting("europe", data2014)
s <- subsetting("europe", data)
View(s)
View(t)
t_opps <- unique(t$opposition_continent)
s <- subset(s, opposition_continent %in% t_opps)
View(s)
View(s)
View(t)
x <- merge(s,t, by=c("continent","opposition_continent"))
View(x)
View(t)
x <- merge(s,t, by=c("continent","opposition_continent", "variable"))
View(x)
t <- subsetting("europe", data2014)
t_opps <- unique(t$opposition_continent)
t$value <- "2014"
s <- subsetting("europe", data)
s <- subset(s, opposition_continent %in% t_opps)
s$value <- "Past"
x <- merge(s,t, by=c("continent","opposition_continent", "value"))
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) gsub(" ", "", tolower(x))))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "", tolower(x))))
t <- subsetting("europe", data2014)
# function to get the data in the correct format for graphing
subsetting <- function(cont,d) {
t1 <- subset(d, continent == cont)
t2 <- subset(d, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
t <- subsetting("europe", data2014)
t_opps <- unique(t$opposition_continent)
t$value <- "2014"
s <- subsetting("europe", data)
s <- subset(s, opposition_continent %in% t_opps)
s$value <- "Past"
x <- merge(s,t, by=c("continent","opposition_continent", "value"))
View(s)
View(t)
x <- merge(s,t, by=c("continent","opposition_continent", "variable"))
View(x)
x <- merge(s,t, by=c("continent","opposition_continent"))
View(x)
x <- rbind(s,t)
View(x)
for_comparison <- function(cont) {
d1 <- subsetting(cont, data2014)
d1$value <- "2014"
d1_opps <- unique(d1$opposition_continent)
d2 <- subsetting(cont, data)
d2 <- subset(data, opposition_continent %in% d1_opps)
d2$value <- "Past"
m <- rbind(d1, d2)
}
# concacaf
m <- for_comparison("concacaf")
for_comparison <- function(cont) {
d1 <- subsetting(cont, data2014)
d1$value <- "2014"
d1_opps <- unique(d1$opposition_continent)
d2 <- subsetting(cont, data)
d2 <- subset(d2, opposition_continent %in% d1_opps)
d2$value <- "Past"
m <- rbind(d1, d2)
}
m <- for_comparison("concacaf")
View(m)
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("CONCACAF -- GF/Game")
t <- subsetting("europe", data2014)
t_opps <- unique(t$opposition_continent)
t$fill <- "2014"
s <- subsetting("europe", data)
s <- subset(s, opposition_continent %in% t_opps)
s$fill <- "Past"
x <- rbind(s,t)
View(x)
for_comparison <- function(cont) {
d1 <- subsetting(cont, data2014)
d1$fill <- "2014"
d1_opps <- unique(d1$opposition_continent)
d2 <- subsetting(cont, data)
d2 <- subset(d2, opposition_continent %in% d1_opps)
d2$fill <- "Past"
m <- rbind(d1, d2)
}
m <- for_comparison("europe")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Europe -- GF/Game")
ggsave(file="europe_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Europe -- GA/Game")
ggsave(file="europe_ga.png")
# concacaf
m <- for_comparison("concacaf")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("CONCACAF -- GF/Game")
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) gsub(" ", "", tolower(x))))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "", tolower(x))))
# function to get the data in the correct format for graphing
subsetting <- function(cont,d) {
t1 <- subset(d, continent == cont)
t2 <- subset(d, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
for_comparison <- function(cont) {
d1 <- subsetting(cont, data2014)
d1$fill <- "2014"
d1_opps <- unique(d1$opposition_continent)
d2 <- subsetting(cont, data)
d2 <- subset(d2, opposition_continent %in% d1_opps)
d2$fill <- "Past"
m <- rbind(d1, d2)
}
# Europe
t <- subsetting("europe",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggsave(file="europe.png")
# do the same for CONCACAF
t <- subsetting("concacaf",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("CONCACAF") + ylim(-3,3)
ggsave(file="concacaf.png")
# and africa
t <- subsetting("africa",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Africa") + ylim(-3,3)
ggsave(file="africa.png")
# and asia
t <- subsetting("asia",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Asia") + ylim(-3,3)
ggsave(file="asia.png")
# and oceania
t <- subsetting("oceania",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Oceania") + ylim(-3,3)
ggsave(file="oceania.png")
# and south america
t <- subsetting("southamerica",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("South America") + ylim(-3,3)
ggsave(file="southamerica.png")
### comparisons to current world cup
# europe
m <- for_comparison("europe")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Europe -- GF/Game")
ggsave(file="europe_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Europe -- GA/Game")
ggsave(file="europe_ga.png")
# concacaf
m <- for_comparison("concacaf")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("CONCACAF -- GF/Game")
ggsave(file="concacaf_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("CONCACAF -- GA/Game")
ggsave(file="concacaf_ga.png")
# africa
m <- for_comparison("africa")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("Africa -- GF/Game")
ggsave(file="africa_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("Africa -- GA/Game")
ggsave(file="africa_ga.png")
# asia
m <- for_comparison("asia")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("Asia -- GF/Game")
ggsave(file="asia_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("Asia -- GA/Game")
ggsave(file="asia_ga.png")
# south america
m <- for_comparison("southamerica")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("South America -- GF/Game")
ggsave(file="southamerica_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("South America -- GA/Game")
ggsave(file="asouthamerica_ga.png")
# europe
m <- for_comparison("europe")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ggtitle("Europe -- GF/Game")
ggsave(file="europe_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ggtitle("Europe -- GA/Game")
ggsave(file="europe_ga.png")
# concacaf
m <- for_comparison("concacaf")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("CONCACAF -- GF/Game")
ggsave(file="concacaf_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("CONCACAF -- GA/Game")
ggsave(file="concacaf_ga.png")
# africa
m <- for_comparison("africa")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Africa -- GF/Game")
ggsave(file="africa_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Africa -- GA/Game")
ggsave(file="africa_ga.png")
# asia
m <- for_comparison("asia")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Asia -- GF/Game")
ggsave(file="asia_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Asia -- GA/Game")
ggsave(file="asia_ga.png")
# south america
m <- for_comparison("southamerica")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("South America -- GF/Game")
ggsave(file="southamerica_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("South America -- GA/Game")
ggsave(file="asouthamerica_ga.png")
