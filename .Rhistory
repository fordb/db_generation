data2014$continent <- as.character(lapply(data2014$continent, function(x) tolower(x)))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "",tolower(x))))
# function to get the data in the correct format for graphing
subsetting <- function(cont, d) {
t1 <- subset(d, continent == cont)
t2 <- subset(d, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
s <- subsetting("europe", data2014)
t <- subsetting("europe", data)
s_opp <- unique(s$opposition_continent)
t <- subset(t, opposition_continent %in% s_opp)
View(t)
View(s)
m <- merge(t, s, by = "opposition_continent")
View(m)
View(s)
View(t)
m <- merge(t, s, by = c("opposition_continent","variable"))
View(m)
m <- merge(t, s, by = c("opposition_continent","variable", "continent"))
View(m)
t$value2014 <- t$value
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
# reformat data
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) tolower(x)))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "",tolower(x))))
# function to get the data in the correct format for graphing
subsetting <- function(cont, d) {
t1 <- subset(d, continent == cont)
t2 <- subset(d, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
s <- subsetting("europe", data2014)
s_opp <- unique(s$opposition_continent)
ggplot(s, aes(x = opposition_continent)) +
geom_bar(data = subset(s, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(s, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("CONCACAF 2014") + ylim(-3,3)
t <- subsetting("europe", data)
t <- subset(t, opposition_continent %in% s_opp)
View(s)
s$value2014 <- s$value
t$valuepast <- t$value
s$value <- t$value <- NULL
m <- merge(t, s, by = c("opposition_continent","variable", "continent"))
View(m)
View(m)
ggplot(m, aes(x = opposition_continent)) +
geom_bar(data = subset(m, variable == "gf_game"), aes(y = value, fill = valuepast, alpha=.8), stat="identity") +
geom_bar(data = subset(m, variable == "ga_game"), aes(y=-value, fill=-value2014, alpha=.8), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggplot(m, aes(x = opposition_continent)) +
geom_bar(data = subset(m, variable == "gf_game"), aes(y = valuepast, fill = valuepast, alpha=.8), stat="identity") +
geom_bar(data = subset(m, variable == "ga_game"), aes(y=-valuepast, fill=-valuepast, alpha=.8), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggplot(m, aes(x = opposition_continent)) +
geom_bar(data = subset(m, variable == "gf_game"), aes(y = valuepast, fill = valuepast), stat="identity") +
geom_bar(data = subset(m, variable == "ga_game"), aes(y=-valuepast, fill=-valuepast), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
m2 -> melt(m)
m2 <- melt(m)
View(m)
View(`m2`)
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
# reformat data
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) tolower(x)))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "",tolower(x))))
# function to get the data in the correct format for graphing
subsetting <- function(cont, d) {
t1 <- subset(d, continent == cont)
t2 <- subset(d, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
s <- subsetting("europe", data2014)
s_opp <- unique(s$opposition_continent)
ggplot(s, aes(x = opposition_continent)) +
geom_bar(data = subset(s, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(s, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("CONCACAF 2014") + ylim(-3,3)
t <- subsetting("europe", data)
t <- subset(t, opposition_continent %in% s_opp)
m <- rbind(t, s)
View(m)
t$fill <- "Past"
s$fill <- "2014"
m <- rbind(t, s)
ggplot(m, aes(x = opposition_continent,fill = fill)) +
geom_bar(data = subset(m, variable == "gf_game"), aes(y = value, fill = value, alpha=.8), stat="identity") +
geom_bar(data = subset(m, variable == "ga_game"), aes(y=-value, fill=-value, alpha=.8), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggplot(m, aes(x = opposition_continent,fill = fill)) +
geom_bar(data = subset(m, variable == "gf_game"), aes(y = value, fill = value), stat="identity", position="dodge") +
geom_bar(data = subset(m, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity", position="dodge") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggplot(m, aes(x = opposition_continent, y = value,fill = fill)) +
geom_bar(data = subset(m, variable == "gf_game"), aes(y = value, fill = value), stat="identity", position="dodge") +
geom_bar(data = subset(m, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity", position="dodge") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggplot(m, aes(x = opposition_continent, y = value,fill = fill)) +
geom_bar(data = subset(m, variable == "gf_game"), aes(y = value), stat="identity", position="dodge") +
geom_bar(data = subset(m, variable == "ga_game"), aes(y=-value), stat = "identity", position="dodge") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggplot(m, aes(x = opposition_continent, y = value, fill = fill)) +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggplot(m, aes(x = opposition_continent, y = value, fill = fill)) + geom_bar(stat="identity",position="dodge")
ggplot(susbet(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) + geom_bar(stat="identity",position="dodge") +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity")
ggplot(susbet(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) + geom_bar(stat="identity",position="dodge")
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) + geom_bar(stat="identity",position="dodge")
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge")
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(data=subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge")
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge")
for_comparison <- function(cont) {
s <- subsetting(cont, data2014)
s_opp <- unique(s$opposition_continent)
t <- subsetting(cont, data)
t <- subset(t, opposition_continent %in% s_opp)
t$fill <- "Past"
s$fill <- "2014"
m <- rbind(t, s)
return(m)
}
m <- for_comparison("europe")
View(m)
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge")
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge")
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + xlim(0,3)
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3)
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3)
View(data)
View(data2014)
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Europe -- GF/Game")
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Europe -- GA/Game")
m <- for_comparison("concacaf")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("CONCACAF -- GF/Game")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("CONCACAF -- GA/Game")
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
# reformat data
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) tolower(x)))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "",tolower(x))))
# function to get the data in the correct format for graphing
subsetting <- function(cont) {
t1 <- subset(data, continent == cont)
t2 <- subset(data, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
for_comparison <- function(cont) {
s <- subsetting(cont, data2014)
s_opp <- unique(s$opposition_continent)
t <- subsetting(cont, data)
t <- subset(t, opposition_continent %in% s_opp)
t$fill <- "Past"
s$fill <- "2014"
m <- rbind(t, s)
return(m)
}
# Europe
t <- subsetting("europe")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggsave(file="europe.png")
# do the same for CONCACAF
t <- subsetting("concacaf")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("CONCACAF") + ylim(-3,3)
ggsave(file="concacaf.png")
# and africa
t <- subsetting("africa")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Africa") + ylim(-3,3)
ggsave(file="africa.png")
# and asia
t <- subsetting("asia")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Asia") + ylim(-3,3)
ggsave(file="asia.png")
# and oceania
t <- subsetting("oceania")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Oceania") + ylim(-3,3)
ggsave(file="oceania.png")
# and south america
t <- subsetting("southamerica")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("South America") + ylim(-3,3)
ggsave(file="southamerica.png")
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
# reformat data
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) tolower(x)))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "",tolower(x))))
# function to get the data in the correct format for graphing
subsetting <- function(cont) {
t1 <- subset(data, continent == cont)
t2 <- subset(data, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
for_comparison <- function(cont) {
s <- subsetting(cont, data2014)
s_opp <- unique(s$opposition_continent)
t <- subsetting(cont, data)
t <- subset(t, opposition_continent %in% s_opp)
t$fill <- "Past"
s$fill <- "2014"
m <- rbind(t, s)
return(m)
}
# Europe
t <- subsetting("europe")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggsave(file="europe.png")
# do the same for CONCACAF
t <- subsetting("concacaf")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("CONCACAF") + ylim(-3,3)
ggsave(file="concacaf.png")
# and africa
t <- subsetting("africa")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Africa") + ylim(-3,3)
ggsave(file="africa.png")
# and asia
t <- subsetting("asia")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Asia") + ylim(-3,3)
ggsave(file="asia.png")
# and oceania
t <- subsetting("oceania")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Oceania") + ylim(-3,3)
ggsave(file="oceania.png")
# and south america
t <- subsetting("southamerica")
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("South America") + ylim(-3,3)
ggsave(file="southamerica.png")
# europe
m <- for_comparison("europe")
library(ggplot2)
library(reshape2)
setwd("~/Desktop/Soccer-Stat/wc-continent-headtohead")
data <- readRDS("breakdown.Rda")
data2014 <- readRDS("wc2014_breakdown.Rda")
# reformat data
data <- data[c("continent","opposition_continent","gf_game","ga_game")]
data2014 <- data2014[c("home_continent","away_continent","gf_game","ga_game")]
names(data2014) <- names(data)
data2014$continent <- as.character(lapply(data2014$continent, function(x) tolower(x)))
data2014$opposition_continent <- as.character(lapply(data2014$opposition_continent, function(x) gsub(" ", "",tolower(x))))
# function to get the data in the correct format for graphing
subsetting <- function(cont, d) {
t1 <- subset(d, continent == cont)
t2 <- subset(d, opposition_continent == cont)
t <- data.frame(continent = c(t1$continent, t2$opposition_continent),
opposition_continent = c(t1$opposition_continent, t2$continent),
gf_game = c(t1$gf_game, t2$ga_game),
ga_game = c(t1$ga_game, t2$gf_game))
t <- melt(t)
return(t)
}
for_comparison <- function(cont) {
s <- subsetting(cont, data2014)
s_opp <- unique(s$opposition_continent)
t <- subsetting(cont, data)
t <- subset(t, opposition_continent %in% s_opp)
t$fill <- "Past"
s$fill <- "2014"
m <- rbind(t, s)
return(m)
}
# Europe
t <- subsetting("europe",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Europe") + ylim(-3,3)
ggsave(file="europe.png")
# do the same for CONCACAF
t <- subsetting("concacaf",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("CONCACAF") + ylim(-3,3)
ggsave(file="concacaf.png")
# and africa
t <- subsetting("africa",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Africa") + ylim(-3,3)
ggsave(file="africa.png")
# and asia
t <- subsetting("asia",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Asia") + ylim(-3,3)
ggsave(file="asia.png")
# and oceania
t <- subsetting("oceania",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("Oceania") + ylim(-3,3)
ggsave(file="oceania.png")
# and south america
t <- subsetting("southamerica",data)
ggplot(t, aes(x = opposition_continent)) +
geom_bar(data = subset(t, variable == "gf_game"), aes(y = value, fill = value), stat="identity") +
geom_bar(data = subset(t, variable == "ga_game"), aes(y=-value, fill=-value), stat = "identity") +
theme(legend.position = "none") + xlab("") + ylab("GA ---- GF") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", midpoint = 0, space = "rgb") +
ggtitle("South America") + ylim(-3,3)
ggsave(file="southamerica.png")
# europe
m <- for_comparison("europe")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Europe -- GF/Game")
ggsave(file="europe_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ggtitle("Europe -- GA/Game")
ggsave(file="europe_ga.png")
# concacaf
m <- for_comparison("concacaf")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("CONCACAF -- GF/Game")
ggsave(file="concacaf_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("CONCACAF -- GA/Game")
ggsave(file="concacaf_ga.png")
# africa
m <- for_comparison("africa")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("Africa -- GF/Game")
ggsave(file="africa_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("Africa -- GA/Game")
ggsave(file="africa_ga.png")
# asia
m <- for_comparison("asia")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("Asia -- GF/Game")
ggsave(file="asia_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("Asia -- GA/Game")
ggsave(file="asia_ga.png")
# south america
m <- for_comparison("southamerica")
# goals for
ggplot(subset(m, variable=="gf_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("South America -- GF/Game")
ggsave(file="southamerica_gf.png")
# goals against
ggplot(subset(m, variable=="ga_game"), aes(x = opposition_continent, y = value, fill = fill)) +
geom_bar(stat="identity",position="dodge") + ylim(0,3) + ylim(0,3) + ggtitle("South America -- GA/Game")
ggsave(file="asouthamerica_ga.png")
